<?php
/**
 * ============================================================================
 * sgiT Education - Matt in 1 Zug v1.0
 * ============================================================================
 * Interaktive Schach-Puzzles: Finde den Zug der den König schachmatt setzt!
 * ============================================================================
 */

session_start();
require_once dirname(__DIR__) . '/includes/version.php';

$userAge = $_SESSION['user_age'] ?? 10;
$userName = $_SESSION['child_name'] ?? 'Schach-Fan';
$childId = $_SESSION['wallet_child_id'] ?? 0;

// Matt-in-1 Puzzles (FEN-ähnliche Notation vereinfacht)
// Format: [board, solution (from-to), hint, sats]
$puzzles = [
    // Einfache Dame-Matts
    [
        'board' => [
            ['', '', '', '', 'k', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', 'Q', '', '', ''],
            ['', '', '', '', 'K', '', '', '']
        ],
        'solution' => ['e2', 'e7'],
        'hint' => 'Die Dame kann direkt vor den König ziehen!',
        'sats' => 15
    ],
    // Turm-Matt an der Grundlinie
    [
        'board' => [
            ['', '', '', '', '', '', '', 'k'],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', 'K', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['R', '', '', '', '', '', '', '']
        ],
        'solution' => ['a1', 'a8'],
        'hint' => 'Der Turm kann die ganze Reihe kontrollieren!',
        'sats' => 18
    ],
    // Dame + König Matt
    [
        'board' => [
            ['', '', '', '', '', '', 'k', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', 'K', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', 'Q', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '']
        ],
        'solution' => ['e4', 'g6'],
        'hint' => 'Bringe die Dame näher zum König!',
        'sats' => 18
    ],
    // Springer-Matt
    [
        'board' => [
            ['', '', '', '', '', '', '', 'k'],
            ['', '', '', '', '', '', 'R', ''],
            ['', '', '', '', '', 'N', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', 'K', '', '', '']
        ],
        'solution' => ['f6', 'g8'],
        'hint' => 'Der Springer kann L-förmig angreifen!',
        'sats' => 22
    ],
    // Läufer + Dame Matt
    [
        'board' => [
            ['', '', '', '', '', '', 'k', ''],
            ['', '', '', '', '', '', 'p', 'p'],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', 'B', '', ''],
            ['', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', 'Q'],
            ['', '', '', '', 'K', '', '', '']
        ],
        'solution' => ['h2', 'h8'],
        'hint' => 'Die Dame kann die h-Linie kontrollieren!',
        'sats' => 20
    ]
];
